{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://accumulate.network/schemas/sdk-map.schema.json",
  "title": "Accumulate SDK Map v1",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "sdk_name",
    "sdk_version",
    "commit",
    "entrypoints",
    "operations"
  ],
  "properties": {
    "sdk_name": { "type": "string", "minLength": 1 },
    "sdk_version": { "type": "string", "minLength": 1 },
    "commit": {
      "type": "string",
      "minLength": 7,
      "description": "Commit SHA (short or full) used to build this map."
    },
    "generated_at": {
      "type": "string",
      "format": "date-time",
      "description": "When this sdk.map.json was generated."
    },
    "entrypoints": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/$defs/entrypoint" }
    },
    "operations": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/$defs/operation" }
    },
    "errors": {
      "type": "array",
      "items": { "$ref": "#/$defs/sdkError" }
    },
    "notes": {
      "type": "string",
      "description": "Optional human-readable notes for agents."
    },
    "code_templates": {
      "type": "array",
      "items": { "$ref": "#/$defs/codeTemplate" },
      "description": "Optional code generation template overrides shipped by the SDK."
    }
  },
  "$defs": {
    "entrypoint": {
      "type": "object",
      "additionalProperties": false,
      "required": ["symbol", "path", "kind"],
      "properties": {
        "symbol": { "type": "string", "minLength": 1 },
        "path": { "type": "string", "minLength": 1 },
        "kind": { "type": "string", "enum": ["class", "function", "module", "namespace"] },
        "doc": { "type": "string" }
      }
    },
    "operation": {
      "type": "object",
      "additionalProperties": false,
      "required": ["op", "symbols", "inputs", "requires", "examples"],
      "properties": {
        "op": {
          "type": "string",
          "minLength": 1,
          "description": "Stable operation id, e.g. send_tokens, create_adi."
        },
        "category": {
          "type": "string",
          "enum": [
            "identity", "authority", "credits", "account",
            "transaction", "query", "proof", "trace", "utility"
          ]
        },
        "symbols": {
          "type": "array",
          "minItems": 1,
          "items": { "$ref": "#/$defs/symbolRef" }
        },
        "inputs": {
          "type": "array",
          "items": { "$ref": "#/$defs/inputParam" }
        },
        "outputs": {
          "type": "array",
          "items": { "$ref": "#/$defs/outputParam" }
        },
        "requires": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "description": "Prerequisite tags agents must satisfy."
        },
        "examples": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 },
          "description": "Repo-relative paths to executable examples."
        },
        "errors": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 }
        }
      }
    },
    "symbolRef": {
      "type": "object",
      "additionalProperties": false,
      "required": ["symbol", "path"],
      "properties": {
        "symbol": { "type": "string", "minLength": 1 },
        "path": { "type": "string", "minLength": 1 },
        "signature": { "type": "string" }
      }
    },
    "inputParam": {
      "type": "object",
      "additionalProperties": false,
      "required": ["name", "type"],
      "properties": {
        "name": { "type": "string", "minLength": 1 },
        "type": { "type": "string", "minLength": 1 },
        "required": { "type": "boolean", "default": true },
        "description": { "type": "string" },
        "example": {}
      }
    },
    "outputParam": {
      "type": "object",
      "additionalProperties": false,
      "required": ["name", "type"],
      "properties": {
        "name": { "type": "string", "minLength": 1 },
        "type": { "type": "string", "minLength": 1 },
        "description": { "type": "string" }
      }
    },
    "codeTemplate": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "language", "operation", "template", "imports"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "language": { "type": "string", "enum": ["python", "javascript", "typescript", "rust", "dart", "csharp"] },
        "operation": { "type": "string", "minLength": 1 },
        "template": { "type": "string", "minLength": 1 },
        "imports": { "type": "array", "items": { "type": "string" } },
        "dependencies": { "type": "array", "items": { "type": "string" } }
      }
    },
    "sdkError": {
      "type": "object",
      "additionalProperties": false,
      "required": ["code", "hint"],
      "properties": {
        "code": { "type": "string", "minLength": 1 },
        "hint": { "type": "string", "minLength": 1 },
        "details": { "type": "string" }
      }
    }
  }
}
